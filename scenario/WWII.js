var WWIIOwners = `
0000000000000000000000000000111000011111111110001000220022222222222222222222222|
0000000000000000000000000000000000001111111100110000020022222222222222222222222|
0000000000000000000000000000000001000111111100110002222022222222222222222222222|
0000000000000000000000000000000111000111111100100002222222222222222222222222222|
0000000000000000000000000000001111000011111100000002222222222222222222222222222|
0000000000000000000000000000001111100011111100000002222222222222222222222222222|
0000000000000000000000000000001111000011100000000002222222222222222222222222222|
0000000000000000000000000000001111111110000000000002222222222222222222222222222|
0000000000000000000000000000000111110000000000000002222222222222222222222222222|
0000000000000000000000000000000111110000000000100111222222222222222222222222222|
0000000000000000000000000000000111000000000011100111112222222222222222222222222|
0000000000000000000000000000000111111111001111111111111222222222222222222222222|
0000000000000000000000000000000111111111111111111111111122222222222222222222222|
0000000000000000000000000000011111111111111111111111111122222222222222222222222|
0000000000000000000000000011111111111111111111111111111111222222222222222222222|
0000000000000000000000000011111111111111111111111111111111222222222222222222222|
0000000000000000000000000111111111111111111111111111111111222222222222222222222|
0000000000000000000000001111111111111111111111111111111111222222222222222222222|
0000000000000000000000011111111111111111111111111111111111222222222222222222222|
0000000000000000000001111111111111111111111111111111111111222222222222222222222|
0000000000000000000001111111111111111111111111111111111111122222222222222222222|
0000000000000000000011111111111111111111111111111111111111122222222222222222222|
0000000000000000000111111111111111111111111111111111111111122222222222222222222|
0000000000000001001111111111111111111111111111111111111111122222222222222222222|
0000000000000001111111111111111111111111111111111111111111122222222222222222222|
0000000000111111111111111111111111111111111111111111111111122222222222222222222|
0000000011111111111111111111111111111111111111111111111111122222222222222222222|
0000000000111111111111111111111111111111111111111111111111112222222222222222222|
0000000000001111111111111111111111111111111111111111111111111122222222222222222|
0000000000000111111111111111111111111111111111111111111111111111222222222222222|
0000000000000011111111111111111111111111111111111111111111111111122222222222022|
0000000000000001111111111111111111111111111111111111111111111111122022222000002|
0000000000000001111111111111111111111111111111111111111111111111110000020000022|
0000000000000001111111111111111111111101111111111111111111111111100002222222222|
0000000000000001111111111111111111111100111111111111111111111111100000022200222|
0000000000000011111111111111111111111100011111111111111111111111000000220000002|
0000000000000111111111111111111001111100011111111111111111111110000000000000000|
0000000000000111111111111111100000111111000111111111111111111110000000000000000|
0000000000000001111111100011000010111111000011111111111111111100000000000000000|
0000000000000000001111100000000110011111000000111111111111111100000000000000000|
0000000000000000000000000000000110001111110000001111111111111100000000000000000|
0000000000000000000000000000000110000111111000001111111111111100000000000000000|
0000000000000000000000000000000000000011111110001111111111111000000000000000000|
0000000000000000000000000000000110000000111111001111111110000000000000000000000|
0000000000000000000000000000000110000000011111000111111110000000000000000000000|
0000000000000000000000000000000110000000001110000111110000000000000000000000000|
0000000000000000000000000000000110000000000110000011111100000000000000000000000|
0000000000000000000000000000000000000000000100000011111110000000000000000000000|
0000000000000000000000000000000000000010111100000011111110000000000000000000000|
0000000000000000000000000000000000000111110000000000100110000000000000000000000|
0000000000000000000000000000000000000001110000000000111100000000000000000000000|
0000000000000000000000000000000000000000010000000000111000000000000000000000000|
0000000000000000000000000000000000000000000000000000001000000000000000000000000|
0000000000000000000000000000000000000000000000000000000000000000000000000000000|
0000000000000000000000000000000000000000000000000000000000000000000000000000000|`
.replace(/\|/g, '').replace(/^\n/, '').replace(/\n$/, '')
  .split('\n');


var WWIITerrains = `
@@@@@mmf@fmmm@@@@@@@@@@@@@@@  p@@@@         c@@@ @@@ff@@fffffffCfffffffffffffff|
@@@@@mf@fmmmmmm@@@@@@@@@@@@@@@@@@@@@        @@  @@@@@f@@fffffffffffffffffff  f |
@@@@@fmmmmmmmmf@@@@@@@@@@@@@@@@@@ @@@       @@  @@@ffff@ffff fffff ff fff  fff |
@@@@@@@mmmmmmff@@@@@@@@@@@@@@@@   @@@       @@ @@@@ffffffffffffffff ffff  fff c|
@@@@@@@mmmcmmc@@@@@@@@@@@@@@@@    @@@@      @@@@@@@fffffffffff fffffffffff ff  |
@@@@@@p@@ffmm @@@@@@@@@@p@@@@@     @@@     p@@@@@@@ ff fff  fffffffffffffffffff|
@@@@@@@@@fmm  @@@@@@@@@@@@@@@@    @@@@   @@@@@@@@@@ffffffffffrrrrrrrrff fffffff|
@@@@@@@@@@     @@@@@@@@@@@@@@@p    c r @@@@@@@@@@@@ffffffffffrf fff rrff ffff  |
@@@@@@@@@@m  m  @@@@@@@@@@@@@@@     @@@@@@@@@@@@@@@ffff fcffrrfff  ffrrfff  C  |
@@@@fm  @@   mm @@@@@@@@@@@@@@@     @@@@@@@@@@ @@ cf fffffffrf f   f frrff     |
@@@@fm   @@@mm m @@@@@@@@@@@@@@   @@@@@@@@@@f  @@  f  ffrrrrrf fc f ff rrrrrrrr|
@fffff   @@ mm   p@@@@@@@@@@@@@        @@  ff cr    f fffffffff f f fffffffff f|
@mmfm   @@@@@mC m @@@@@@@@@@@@@r           ffff rff   ff ff c fffff ffffff ffff|
@        @ @Cm    @@@@@@@@@@@ prr C f     ff   rr       fffff  frrrffffffffffff|
@@  mff @@ mm     p@@@@@@@      rrrrff C  ff  rr           f frrr ffff ff ff f |
@@   fcp@@  m     C p@@@@@       ffrfffffff   rc f  c      ff r fffffcff cfffff|
@   ff  @@@ m        @@@@  c  C    rrmm fC  f rrrff          frffffffffffffffff|
@m mff@@@ mm  rr Crp@@@@ rrr      Cmrrrmf ff  ffrr           frrffff fffffff   |
@@ p@@@@@  m   rrrr@@@@    rrrmm    m rf f ff  f rrr      c  ffrrf ffff        |
@@@@@@@@@@@C      p@@ p   fffrmmm   mmrr           rrr        f rrf    f       |
@@@@@@@@@@      p@@@@    cfffrrr   m   rrrrmm  f c  fr        f  rr  c ff      |
@@@@@@@@@  p@@@@@@@@     mmf  crm  m  fmmmrmm   f    r        f  frr      f   c|
@@@@@@@@p @@@@@@@@@     ffffmrrr mm  fmm cr  mm      rc        c f rr   ff     |
@@@@@@@@@@@@@@@ @@        fmmrmfff   ffm  r  fmfff   rrrr    f   f  rrf   f  f |
@@@@@@@@@@@@@@@ p   C      m rrfmf mm mfm r  mmmmfffffffrrrrr        rr        |
@@@@@@@@@@  f         f   fffmrfmrrrrrrfmmm mfmmmmmmmmmmmfffrr fff    rrr f  f |
@@@@@@@@  cff        ff  c ffmrmmrfc  rfffffmmmmmmmfmmmmmmmffrrf        r      |
@@@@@@@@@@ffff       fmm  ffm rrrrfff rmmffffff    fm     mmmfr         r  c   |
@@@@@@@@@@@@   c    f m  ffmm  mmmmmmmrrcffff             m mfr c      rr      |
@@@@@@@@@@@@@p     rrrrr f     mmmmmmmmrrrmff    c         mmmrr      rr      C|
@@@@@@@@@@@@@@rrrrrr   rr     mmmmmmmmmmmrrf         mmm  fmmffr    rrr     @  |
@@@@@@@@@@@@@@@      f cr f rrrfmmmmmmmm fr          fff  fmff rr  @r    @@@@@ |
@@@@@@@@@@@@@@@f   fmf  r  rrmmfffmmffm ffr c       mfffff m    r @@@@@r@@@@@  |
@@@@@@@@@@@@@@@fff mmfmfrmrrrmmc ffffC@f fr          mffmfmmC rrr@@@@   ff r   |
@@@@@@@@@@@@@@@fcf fffffmrrmmm rrrrr  @@ffrrrmm  m    mmmmm  rr  @@@@@@ ff@@   |
@@@@@@@@@@@@@@fffffm mfmrrfmmfffff rr @@@ mfrf       mmm    rrff@@@@@@ c@@@@@@ |
@@@@@@@@@@@@@mmff   ffmmrfmmmff@@fmmrr@@@  frrfc  m m      rr f@@@@@@@@@@@@@@@@|
@@@@@@@@@@@@@mm    fcmmfrcmcm@@@@@mmmm c@@@  rr  mfff          @@@@@@@@@@@@@@@@|
@@@@@@@@@@@@@@@mmmmmmmm@@@mp@@@@f@fffmm @@@@p rrrrr f        p@@@@@@@@@@@@@@@@@|
@@@@@@@@@@@@@@@@@@mmmmm@@@@@@@@ff@@fffmm@@@@@@  ffrrrr  c     @@@@@@@@@@@@@@@@@|
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@fp@@@fCfm  @@@@@@ fc frrrm    f@@@@@@@@@@@@@@@@@|
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ff@@@@pfmm  @@@@@ f  m  rfffff @@@@@@@@@@@@@@@@@|
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ mfm c @@@ mm fmmrrrrrr@@@@@@@@@@@@@@@@@@|
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@  @@@@@@@cmm   @@ fff m m @@@@@@@@@@@@@@@@@@@@@@|
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ f@@@@@@@@fmm @@@fmff f  @@@@@@@@@@@@@@@@@@@@@@@|
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ f@@@@@@@@@fm @@@@f mm @@@@@@@@@@@@@@@@@@@@@@@@@|
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@pf@@@@@@@@@@m @@@@@ffmmff@@@@@@@@@@@@@@@@@@@@@@@|
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@m@@@@@@   mfff@@@@@@@@@@@@@@@@@@@@@@|
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@c@fmrm@@@@@@@ f ff @@@@@@@@@@@@@@@@@@@@@@|
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@p  mm@@@@@@@@@@r@@ c@@@@@@@@@@@@@@@@@@@@@@|
@@@@@@@@@@@@@@@@@@@@@ddp@@@@@d@@ddc@@@@  c@@@@@@@@@@ffrr@@@@@@@@@@@@@@@@@@@@@@@|
@@@@@@@@@@@@@@@@@@@@dddddcdddddddddp@@@@@ @@@@@@@@@@ fc@@@@@@@@@@@@@@@@@@@@@@@@|
@@@@@@@@@@@@@@@@@@ddddddddddddddddd@@@@@@@@@@@@@@@@@@@p@@@@@@@@@@@@@@@@@@@@@@@@|
@@@@@@@@@p@@@@@@ddddddmmmmmmmdddddd@@dpd@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@|
@@@@@@@cdddddddddmmmmmmmmmmmmmmmdddd@@@@@@@@@@@@@@@@@@@@mpmm@@@@@@@@@mmp@@@@@@@|`
.replace(/\|/g, '').replace(/^\n/, '').replace(/\n$/, '')
  .split('\n');
  
function loadWWIIScenario() {
  // ============== map =================
  MAP_DATA = WWIITerrains.map((x, row) => (x.split('').map((v, col) => {
	  let o = parseInt(WWIIOwners[row][col]);
	  let slots = [];
    let terrain = '@';
	  if (v == 'c'){
      terrain = 'U';
      slots = Array(1).fill('F');
	  } else if (v == 'C') {
      terrain = 'U';
      slots = Array(25).fill('F');
    } else if (v == 'p' || v == 'm' || v == ' ' || v == 'f' || v == 'd' || v == 'r') {
      terrain = v.toUpperCase();
    }
    if (!TERRAINS[terrain]) throw 'Not found ' + v;
    return {terrain: terrain, owner: o, slots: slots, divisions: [], pt: pt(row, col)}
  })));
  
  window.PORTS = [];
  PLAYERS.forEach(x => delete x._mapDataFlattened);
  
  // ============== players =================
  
  PLAYERS[0].color = "rgba(140, 193, 226, 0.2)";
  PLAYERS[0].manpower = 5500000;
  PLAYERS[0].growthRate = 139187/47080000; // 0.0029563933
  PLAYERS[1].color = "rgba(96, 96, 96, 0.2)";
  PLAYERS[1].manpower = 7500000;
  PLAYERS[1].growthRate = 482790/67349000; // 0.0071684806
  
  PLAYERS[0].light = 1000;
  PLAYERS[0].heavy = 2000;
  PLAYERS[1].light = -100;
  PLAYERS[1].heavy = -100;
  
  PLAYERS[1].generals["Generalissimo"]["Chiang Kai-Shek"].selected=false;
  PLAYERS[1].generals["Generalissimo"]["Game Founder"].selected=true;
  PLAYERS[1].sumAllGeneralTraits;
  
  window.p3 = new Player();
  p3.color = 'rgba(150, 0, 0, 0.2)';
  p3.manpower = 10000000;
  p3.growthRate = 2012000/162039470; // 0.01241672785
  p3.light = -200;
  p3.heavy = -100;
  p3.factoryInLight = 1;
  p3.sumAllGeneralTraits;
  
  // ============== military =================
  
  let british = new Template(12100, 18, 9, 'Division');
  let american = new Template(11600, 18, 8, 'US Infantry Division');
  let german = new Template(14300, 22, 9, 'Infanterie-Division');
  let italian = new Template(8900, 16, 6, 'Intalian Infantry Division');
  let germanPanzer = new Template(17800, 12, 30, 'Panzer Corps');
  let soviet = new Template(13100, 12, 10, 'Rifle Division');
  let sovietMilitia = new Template(12000, 9, 4, 'Militia Division');
  
  let british_i = 0;
  let german_i = 0;
  let soviet_i = 0;
  
  MAP_DATA.forEach((x, row) => (x.forEach((v, col) => {
    if (v.terrain == '@') return;
    if (v.terrain == 'P')
      PORTS.push(pt(row, col));
    if (v.owner == 0) {
      let type = Math.random() < 0.7 ? british : american;
      if (v.terrain == 'P' || v.terrain == 'U')
        v.divisions = Array((Math.random() * 3).round() + 2).fill(0).map(() => (new Division(v.owner, ++british_i + 'th ' + type.defaultName, pt(row, col), type)));
    } else if (v.pt.adjacentNotToPlayer(v.pt.owner) > 0 || v.terrain == 'P' || v.terrain == 'U')
      if (v.owner == 1 && v.terrain != 'U') {
        let type = Math.random() < 0.9 ? (Math.random() < 0.7 ? german : italian) : germanPanzer;
        v.divisions = Array((Math.random() * 2).round() + 2).fill(0).map(() => (new Division(v.owner, ++german_i + 'th ' + type.defaultName, pt(row, col), type)));
      } else if (v.owner == 2) {
        let type = Math.random() < 0.6 ? soviet : sovietMilitia;
        v.divisions = Array((Math.random() * 3).round() + 1).fill(0).map(() => (new Division(v.owner, ++soviet_i + 'th ' + type.defaultName, pt(row, col), type)));
      }
  })));
  
  // ============= misc ==============
  window.timestamp = -900241200; // 6/22/1941
  window.timeIncrement = 518400 / 2; // 3 days
  
  reinitCanvas();
  updateInterfaceOnPass();
}
